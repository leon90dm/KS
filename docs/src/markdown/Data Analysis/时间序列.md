# 时间序列

## 基本定义

$\rho_l$
:   $\frac{Cov\left(r_{t}, r_{t-l}\right)}{Var\left(r_{t}\right)}$   间隔 $l$ 的自相关系数。

## 平稳性

=== "严平稳"
    ($r_1,\dots,r_t$) 的联合分布在时间的平移变换下 **保持不变**。

=== "弱平稳"
    1. 一阶矩为常数，$E(r_t) = u$ 均值为常数。
    2. 二阶矩收敛，$E(r_t^2) < \infty$.
    3. $Cov(r_t, r_{t-l}) = \gamma_l$ 结果只依赖于 $l$ ，而不依赖于 $t$

## 纯随机检验

纯随机检验也称为 **白噪声检验** 

=== "Q统计量"
    todo
=== "LB统计量"
    todo

## 预测方法

有时候最简单的预测方法可能会是最好的预测方法，但是在很多情况下，这些方法只是作为基准方法而不是被直接运用。也就是说，我们提出的任何预测方法都会和这些简单方法比较，以保证其预测结果优于这些简单方法，否则，新的方法就不值得考虑。

=== "均值法"
    $\hat{y}_{T+h|T} = E(y_i)$ 其中 $h$ 为预测期数。

    ```R
        meanf(ts, h=11)
    ```

=== "Naive"
    所有预测值设置为最后一次观测值：$\hat{y}_{T+h|T} = y_T$。 这种方法看似简单，但当数据服从 *随机游走* 过程时，Naive预测是最优的。因此也被称为“随机游走预测”。

    ```R
        naive(ts, h=11)
    ```

=== "季节性Naive"
    将预测值设置为去年同一个季节前一期的观测值： $\hat{y}_{T+h|T} = y_{T+h-km}$， 其中 $m$ 为周期长度，比如：对于月度数据，未来所有二月的预测值都等于前一年二月的观测值。

    ```R
        snaive(ts, h=11)
    ```

=== "漂移法"
     允许预测值随着时间的推移增大或减小，并且我们假定单位时间改变量（称作 “漂移”）等于历史数据的平均改变量，$\hat{y}_{T+h|T} = y_T + h\frac{y_T - y_1}{T - 1}$ 。

    ```R
        rwf(ts, h=11)
    ```

## 数据变换

=== "日历调整"
    1. 将月总和调整为日均（每个月天数不一样）
=== "人口调整"
    1. 任何受人口数量影响的数据都可以调整为人均数据，换句话说，考虑每人（或每千人，或每百万人）而非所有人。
=== "通胀调整"
    通胀调整需要用到价格指数 $z_t$ 
=== "数学变换"
    1. log变换 $w_t = log(y_t)$
    2. 幂变换, "Box-cox"变换[^boxcox]

## 残差

一个好的预测方法产生的残差具有以下特性：

=== "不相关"
    如果残差之间存在相关性，那么残差中包含的数据信息应该被用于计算预测值。
=== "均值为零"
    如果残差的均值不为零，那么说明预测是有偏差的。

除了上述的基本性质外，残差最好也满足下列两个性质，因为它们能够让预测区间的计算变得容易。（但不是必须满足）：

===! "常数方差"
     残差的方差是常数
=== "正态分布"
     残差满足正态分布





[^boxcox]: $$w_{t}=\left\{\begin{array}{ll}
            \log \left(y_{t}\right) & \text { if } \lambda=0 \\
            \left(y_{t}^{\lambda}-1\right) / \lambda & \text { otherwise }
            \end{array}\right.$$